(self.webpackChunkmediadc=self.webpackChunkmediadc||[]).push([["src_views_Collector_vue"],{48959:t=>{self,t.exports=function(){var t={291:function(t,e,n){"use strict";var i=n(7537),s=n.n(i),a=n(3645),r=n.n(a)()(s());r.push([t.id,".material-design-icon[data-v-3d7aaa3a]{display:flex;align-self:center;justify-self:center;align-items:center;justify-content:center}.progress-bar[data-v-3d7aaa3a]{display:block;width:100%;background:var(--color-background-dark);border:0;padding:0;height:var(--progress-bar-height);border-radius:calc(var(--progress-bar-height)/2)}.progress-bar[data-v-3d7aaa3a]::-webkit-progress-bar{height:var(--progress-bar-height)}.progress-bar[data-v-3d7aaa3a]::-webkit-progress-value{background:linear-gradient(40deg, var(--color-primary-element) 0%, var(--color-primary-element-light) 100%);border-radius:calc(var(--progress-bar-height)/2)}.progress-bar[data-v-3d7aaa3a]::-moz-progress-bar{background:linear-gradient(40deg, var(--color-primary-element) 0%, var(--color-primary-element-light) 100%);border-radius:calc(var(--progress-bar-height)/2)}.progress-bar--error[data-v-3d7aaa3a]::-moz-progress-bar{background:var(--color-error) !important}.progress-bar--error[data-v-3d7aaa3a]::-webkit-progress-value{background:var(--color-error) !important}","",{version:3,sources:["webpack://./src/assets/material-icons.css","webpack://./src/components/NcProgressBar/NcProgressBar.vue"],names:[],mappings:"AAGA,uCACC,YAAA,CACA,iBAAA,CACA,mBAAA,CACA,kBAAA,CACA,sBAAA,CCLD,+BACC,aAAA,CACA,UAAA,CACA,uCAAA,CACA,QAAA,CACA,SAAA,CACA,iCAAA,CACA,gDAAA,CACA,qDACC,iCAAA,CAED,uDACC,2GAAA,CACA,gDAAA,CAED,kDACC,2GAAA,CACA,gDAAA,CAIA,yDACC,wCAAA,CAED,8DACC,wCAAA",sourcesContent:["/*\n* Ensure proper alignment of the vue material icons\n*/\n.material-design-icon {\n\tdisplay: flex;\n\talign-self: center;\n\tjustify-self: center;\n\talign-items: center;\n\tjustify-content: center;\n}\n","@use 'sass:math'; $scope_version:\"d8e8570\"; @import 'variables'; @import 'material-icons';\n\n\n.progress-bar {\n\tdisplay: block;\n\twidth: 100%;\n\tbackground: var(--color-background-dark);\n\tborder: 0;\n\tpadding: 0;\n\theight: var(--progress-bar-height);\n\tborder-radius: calc(var(--progress-bar-height) / 2);\n\t&::-webkit-progress-bar {\n\t\theight: var(--progress-bar-height);\n\t}\n\t&::-webkit-progress-value {\n\t\tbackground: linear-gradient(40deg, var(--color-primary-element) 0%, var(--color-primary-element-light) 100%);\n\t\tborder-radius: calc(var(--progress-bar-height) / 2);\n\t}\n\t&::-moz-progress-bar {\n\t\tbackground: linear-gradient(40deg, var(--color-primary-element) 0%, var(--color-primary-element-light) 100%);\n\t\tborder-radius: calc(var(--progress-bar-height) / 2);\n\t}\n\t&--error {\n\t\t// Override previous values\n\t\t&::-moz-progress-bar {\n\t\t\tbackground: var(--color-error) !important;\n\t\t}\n\t\t&::-webkit-progress-value {\n\t\t\tbackground: var(--color-error) !important;\n\t\t}\n\t}\n}\n\n"],sourceRoot:""}]),e.Z=r},3645:function(t){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",i=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),i&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),i&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,i,s,a){"string"==typeof t&&(t=[[null,t,void 0]]);var r={};if(i)for(var o=0;o<this.length;o++){var c=this[o][0];null!=c&&(r[c]=!0)}for(var l=0;l<t.length;l++){var d=[].concat(t[l]);i&&r[d[0]]||(void 0!==a&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=a),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),s&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=s):d[4]="".concat(s)),e.push(d))}},e}},7537:function(t){"use strict";t.exports=function(t){var e=t[1],n=t[3];if(!n)return e;if("function"==typeof btoa){var i=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),s="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(i),a="/*# ".concat(s," */"),r=n.sources.map((function(t){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(t," */")}));return[e].concat(r).concat([a]).join("\n")}return[e].join("\n")}},3379:function(t){"use strict";var e=[];function n(t){for(var n=-1,i=0;i<e.length;i++)if(e[i].identifier===t){n=i;break}return n}function i(t,i){for(var a={},r=[],o=0;o<t.length;o++){var c=t[o],l=i.base?c[0]+i.base:c[0],d=a[l]||0,u="".concat(l," ").concat(d);a[l]=d+1;var m=n(u),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==m)e[m].references++,e[m].updater(p);else{var h=s(p,i);i.byIndex=o,e.splice(o,0,{identifier:u,updater:h,references:1})}r.push(u)}return r}function s(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,s){var a=i(t=t||[],s=s||{});return function(t){t=t||[];for(var r=0;r<a.length;r++){var o=n(a[r]);e[o].references--}for(var c=i(t,s),l=0;l<a.length;l++){var d=n(a[l]);0===e[d].references&&(e[d].updater(),e.splice(d,1))}a=c}}},569:function(t){"use strict";var e={};t.exports=function(t,n){var i=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(n)}},9216:function(t){"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},3565:function(t,e,n){"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},7795:function(t){"use strict";t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var i="";n.supports&&(i+="@supports (".concat(n.supports,") {")),n.media&&(i+="@media ".concat(n.media," {"));var s=void 0!==n.layer;s&&(i+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),i+=n.css,s&&(i+="}"),n.media&&(i+="}"),n.supports&&(i+="}");var a=n.sourceMap;a&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleTagTransform(i,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},4589:function(t){"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},8070:function(){},1900:function(t,e,n){"use strict";function i(t,e,n,i,s,a,r,o){var c,l="function"==typeof t?t.options:t;if(e&&(l.render=e,l.staticRenderFns=n,l._compiled=!0),i&&(l.functional=!0),a&&(l._scopeId="data-v-"+a),r?(c=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),s&&s.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(r)},l._ssrRegister=c):s&&(c=o?function(){s.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:s),c)if(l.functional){l._injectStyles=c;var d=l.render;l.render=function(t,e){return c.call(e),d(t,e)}}else{var u=l.beforeCreate;l.beforeCreate=u?[].concat(u,c):[c]}return{exports:t,options:l}}n.d(e,{Z:function(){return i}})}},e={};function n(i){var s=e[i];if(void 0!==s)return s.exports;var a=e[i]={id:i,exports:{}};return t[i](a,a.exports,n),a.exports}n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.nc=void 0;var i={};return function(){"use strict";n.r(i),n.d(i,{default:function(){return x}});var t={name:"NcProgressBar",props:{value:{type:Number,default:0,validator:function(t){return t>=0&&t<=100}},size:{type:String,default:"small",validator:function(t){return-1!==["small","medium"].indexOf(t)}},error:{type:Boolean,default:!1}},computed:{height:function(){return"small"===this.size?"4px":"6px"}}},e=n(3379),s=n.n(e),a=n(7795),r=n.n(a),o=n(569),c=n.n(o),l=n(3565),d=n.n(l),u=n(9216),m=n.n(u),p=n(4589),h=n.n(p),A=n(291),f={};f.styleTagTransform=h(),f.setAttributes=d(),f.insert=c().bind(null,"head"),f.domAPI=r(),f.insertStyleElement=m(),s()(A.Z,f),A.Z&&A.Z.locals&&A.Z.locals;var g=n(1900),v=n(8070),k=n.n(v),y=(0,g.Z)(t,(function(){var t=this;return(0,t._self._c)("progress",{staticClass:"progress-bar vue",class:{"progress-bar--error":t.error},style:{"--progress-bar-height":t.height},attrs:{max:"100"},domProps:{value:t.value}})}),[],!1,null,"3d7aaa3a",null);"function"==typeof k()&&k()(y);var x=y.exports}(),i}()},13491:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});var i=n(87537),s=n.n(i),a=n(23645),r=n.n(a)()(s());r.push([t.id,"\n.list-enter-active[data-v-7f09c3f2],\n.list-leave-active[data-v-7f09c3f2] {\n\ttransition: all 1s ease;\n}\n.list-enter-from[data-v-7f09c3f2],\n.list-leave-to[data-v-7f09c3f2] {\n\topacity: 0;\n\ttransform: translateY(30px);\n}\n.tasks-list[data-v-7f09c3f2] {\n\tpadding: 20px;\n\tbackground-color: var(--color-primary-element-light);\n\tborder-radius: var(--border-radius-large);\n\twidth: 100%;\n\tmargin: 10px;\n\tmax-width: 600px;\n\tmax-height: 482px;\n\tmin-height: 410px;\n\toverflow-y: scroll;\n}\n.task-row[data-v-7f09c3f2] {\n\tdisplay: flex;\n\talign-items: center;\n\tmargin-bottom: 10px;\n\ttransition: box-shadow .3s;\n\tborder-radius: var(--border-radius-pill);\n\tborder-color: var(--color-border-dark);\n}\n.task-row[data-v-7f09c3f2]:hover {\n\tbox-shadow: 0 0 10px 0 rgba(0, 0, 0, 0.1);\n}\n@media (max-width: 540px) {\n.task-row[data-v-7f09c3f2], .task-row a[data-v-7f09c3f2] {\n\t\tflex-direction: column;\n\t\tpadding: 5px;\n}\n.delete-task-button[data-v-7f09c3f2] {\n\t\tvisibility: visible;\n}\n}\n.empty-tasks-list[data-v-7f09c3f2] {\n\tpadding: 20px;\n\twidth: 100%;\n\theight: 80%;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tbox-sizing: border-box;\n\tflex-direction: column;\n}\n","",{version:3,sources:["webpack://./src/components/tasks/TasksList.vue"],names:[],mappings:";AAyFA;;CAEA,uBAAA;AACA;AAEA;;CAEA,UAAA;CACA,2BAAA;AACA;AAEA;CACA,aAAA;CACA,oDAAA;CACA,yCAAA;CACA,WAAA;CACA,YAAA;CACA,gBAAA;CACA,iBAAA;CACA,iBAAA;CACA,kBAAA;AACA;AAEA;CACA,aAAA;CACA,mBAAA;CACA,mBAAA;CACA,0BAAA;CACA,wCAAA;CACA,sCAAA;AACA;AAEA;CACA,yCAAA;AACA;AAEA;AACA;EACA,sBAAA;EACA,YAAA;AACA;AACA;EACA,mBAAA;AACA;AACA;AAEA;CACA,aAAA;CACA,WAAA;CACA,WAAA;CACA,aAAA;CACA,mBAAA;CACA,uBAAA;CACA,sBAAA;CACA,sBAAA;AACA",sourcesContent:["\x3c!--\n - @copyright Copyright (c) 2021 Andrey Borysenko <andrey18106x@gmail.com>\n -\n - @copyright Copyright (c) 2021 Alexander Piskun <bigcat88@icloud.com>\n -\n - @author Andrey Borysenko <andrey18106x@gmail.com>\n -\n - @license AGPL-3.0-or-later\n -\n - This program is free software: you can redistribute it and/or modify\n - it under the terms of the GNU Affero General Public License as\n - published by the Free Software Foundation, either version 3 of the\n - License, or (at your option) any later version.\n -\n - This program is distributed in the hope that it will be useful,\n - but WITHOUT ANY WARRANTY; without even the implied warranty of\n - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n - GNU Affero General Public License for more details.\n -\n - You should have received a copy of the GNU Affero General Public License\n - along with this program. If not, see <http://www.gnu.org/licenses/>.\n -\n --\x3e\n\n<template>\n\t<div class=\"tasks-list\">\n\t\t<h2>{{ t('mediadc', 'Recent Tasks') }}</h2>\n\t\t<div v-if=\"tasks.length > 0\">\n\t\t\t<transition-group name=\"list\" tag=\"ul\">\n\t\t\t\t<TasksListItem v-for=\"task in tasks\"\n\t\t\t\t\t:key=\"task.id\"\n\t\t\t\t\tclass=\"task-row\"\n\t\t\t\t\t:task=\"task\" />\n\t\t\t</transition-group>\n\t\t</div>\n\t\t<div v-else class=\"empty-tasks-list\">\n\t\t\t<NcEmptyContent style=\"margin-top: 5vh;\"\n\t\t\t\t:title=\"t('mediadc', 'No tasks yet')\"\n\t\t\t\t:description=\"t('mediadc', 'Create a new one!')\">\n\t\t\t\t<template #icon>\n\t\t\t\t\t<ClipboardListOutline />\n\t\t\t\t</template>\n\t\t\t</NcEmptyContent>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport { mapActions, mapGetters } from 'vuex'\n\nimport NcEmptyContent from '@nextcloud/vue/dist/Components/NcEmptyContent.js'\nimport ClipboardListOutline from 'vue-material-design-icons/ClipboardListOutline.vue'\n\nimport Formats from '../../mixins/Formats.js'\nimport TasksListItem from './TasksListItem.vue'\n\nexport default {\n\tname: 'TasksList',\n\tcomponents: {\n\t\tTasksListItem,\n\t\tNcEmptyContent,\n\t\tClipboardListOutline,\n\t},\n\tmixins: [Formats],\n\tdata() {\n\t\treturn {\n\t\t\ttasksUpdater: null,\n\t\t}\n\t},\n\tcomputed: {\n\t\t...mapGetters([\n\t\t\t'tasks',\n\t\t]),\n\t},\n\tbeforeMount() {\n\t\tthis.tasksUpdater = setInterval(() => this.getTasks(true), 5000)\n\t},\n\tbeforeDestroy() {\n\t\tclearInterval(this.tasksUpdater)\n\t},\n\tmethods: {\n\t\t...mapActions([\n\t\t\t'getTasks',\n\t\t]),\n\t},\n}\n<\/script>\n\n<style scoped>\n.list-enter-active,\n.list-leave-active {\n\ttransition: all 1s ease;\n}\n\n.list-enter-from,\n.list-leave-to {\n\topacity: 0;\n\ttransform: translateY(30px);\n}\n\n.tasks-list {\n\tpadding: 20px;\n\tbackground-color: var(--color-primary-element-light);\n\tborder-radius: var(--border-radius-large);\n\twidth: 100%;\n\tmargin: 10px;\n\tmax-width: 600px;\n\tmax-height: 482px;\n\tmin-height: 410px;\n\toverflow-y: scroll;\n}\n\n.task-row {\n\tdisplay: flex;\n\talign-items: center;\n\tmargin-bottom: 10px;\n\ttransition: box-shadow .3s;\n\tborder-radius: var(--border-radius-pill);\n\tborder-color: var(--color-border-dark);\n}\n\n.task-row:hover {\n\tbox-shadow: 0 0 10px 0 rgba(0, 0, 0, 0.1);\n}\n\n@media (max-width: 540px) {\n\t.task-row, .task-row a {\n\t\tflex-direction: column;\n\t\tpadding: 5px;\n\t}\n\t.delete-task-button {\n\t\tvisibility: visible;\n\t}\n}\n\n.empty-tasks-list {\n\tpadding: 20px;\n\twidth: 100%;\n\theight: 80%;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tbox-sizing: border-box;\n\tflex-direction: column;\n}\n</style>\n"],sourceRoot:""}]);const o=r},25680:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});var i=n(87537),s=n.n(i),a=n(23645),r=n.n(a)()(s());r.push([t.id,"\n.list-item {\n\tmargin: 0 !important;\n}\n","",{version:3,sources:["webpack://./src/components/tasks/TasksListItem.vue"],names:[],mappings:";AAkHA;CACA,oBAAA;AACA",sourcesContent:["\x3c!--\n - @copyright Copyright (c) 2022 Andrey Borysenko <andrey18106x@gmail.com>\n -\n - @copyright Copyright (c) 2022 Alexander Piskun <bigcat88@icloud.com>\n -\n - @author 2022 Andrey Borysenko <andrey18106x@gmail.com>\n -\n - @license AGPL-3.0-or-later\n -\n - This program is free software: you can redistribute it and/or modify\n - it under the terms of the GNU Affero General Public License as\n - published by the Free Software Foundation, either version 3 of the\n - License, or (at your option) any later version.\n -\n - This program is distributed in the hope that it will be useful,\n - but WITHOUT ANY WARRANTY; without even the implied warranty of\n - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n - GNU Affero General Public License for more details.\n -\n - You should have received a copy of the GNU Affero General Public License\n - along with this program. If not, see <http://www.gnu.org/licenses/>.\n -\n --\x3e\n\n<template>\n\t<NcListItem :title=\"listItemTitle\"\n\t\t:bold=\"true\"\n\t\t:force-display-actions=\"true\"\n\t\t:to=\"{ name: 'collectorDetails', params: { taskId: task.id } }\"\n\t\tclass=\"task-list-item\">\n\t\t<template #icon>\n\t\t\t<span :class=\"'badge ' + getStatusBadge(task)\">{{ getStatusBadge(task) }}</span>\n\t\t</template>\n\t\t<template #subtitle>\n\t\t\t{{ listItemDetails }}\n\t\t\t<NcProgressBar :value=\"Math.round((task.files_scanned / task.files_total) * 100)\"\n\t\t\t\tsize=\"small\"\n\t\t\t\t:error=\"getStatusBadge(task) === 'error'\" />\n\t\t</template>\n\t\t<template #actions>\n\t\t\t<NcActionButton icon=\"icon-history\" :close-after-click=\"true\" @click=\"restartTask(task)\">\n\t\t\t\t{{ getStatusBadge(task) === 'duplicated' ? t('mediadc', 'Start') : t('mediadc', 'Restart') }}\n\t\t\t</NcActionButton>\n\t\t\t<NcActionButton icon=\"icon-pause\" :close-after-click=\"true\" @click=\"terminateTask(task)\">\n\t\t\t\t{{ t('mediadc', 'Stop') }}\n\t\t\t</NcActionButton>\n\t\t\t<NcActionButton v-tooltip=\"{content: t('mediadc', 'Create copy of the task'), placement: 'left'}\"\n\t\t\t\t:close-after-click=\"true\"\n\t\t\t\t@click=\"duplicateTask(task)\">\n\t\t\t\t{{ t('mediadc', 'Duplicate') }}\n\t\t\t\t<template #icon>\n\t\t\t\t\t<ContentCopy :size=\"16\" />\n\t\t\t\t</template>\n\t\t\t</NcActionButton>\n\t\t\t<NcActionButton icon=\"icon-delete\" :close-after-click=\"true\" @click=\"deleteTask(task)\">\n\t\t\t\t{{ t('mediadc', 'Delete') }}\n\t\t\t</NcActionButton>\n\t\t</template>\n\t</NcListItem>\n</template>\n\n<script>\nimport { mapActions, mapGetters } from 'vuex'\n\nimport NcActionButton from '@nextcloud/vue/dist/Components/NcActionButton.js'\nimport ContentCopy from 'vue-material-design-icons/ContentCopy.vue'\nimport NcProgressBar from '@nextcloud/vue/dist/Components/NcProgressBar.js'\nimport NcListItem from '@nextcloud/vue/dist/Components/NcListItem.js'\n\nimport Formats from '../../mixins/Formats.js'\n\nexport default {\n\tname: 'TasksListItem',\n\tcomponents: {\n\t\tNcActionButton,\n\t\tContentCopy,\n\t\tNcListItem,\n\t\tNcProgressBar,\n\t},\n\tmixins: [Formats],\n\tprops: {\n\t\ttask: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\t...mapGetters([\n\t\t\t'tasks',\n\t\t]),\n\t\tlistItemTitle() {\n\t\t\treturn `${this.parseTargetMtype(this.task)}\n\t\t\t\t${this.task.files_scanned !== this.task.files_total ? this.task.files_scanned + '/' : ''}${this.task.files_total} ${this.n('mediadc', 'file', 'files', this.task.files_total)}\n\t\t\t\t(${this.formatBytes(Number(this.task.files_total_size))})`\n\t\t},\n\t\tlistItemDetails() {\n\t\t\treturn `${this.parseUnixTimestamp(this.task.created_time)}\n\t\t\t\t${Number(this.task.finished_time) > 0 ? ' - ' + this.parseUnixTimestamp(this.task.finished_time) : ''}`\n\t\t},\n\t},\n\tmethods: {\n\t\t...mapActions([\n\t\t\t'getTasks',\n\t\t\t'getSettings',\n\t\t\t'deleteTask',\n\t\t\t'duplicateTask',\n\t\t\t'terminateTask',\n\t\t\t'restartTask',\n\t\t]),\n\t},\n}\n<\/script>\n\n<style>\n.list-item {\n\tmargin: 0 !important;\n}\n</style>\n\n<style scoped>\n.task-list-item {\n\tborder: 1px solid #dadada;\n\tbackground-color: var(--color-main-background);\n\tborder-radius: 16px;\n}\n\n@media (max-width: 540px) {\n\t.badge {\n\t\tmargin-right: 0;\n\t\tmargin-bottom: 10px;\n\t}\n}\n</style>\n"],sourceRoot:""}]);const o=r},91144:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});var i=n(87537),s=n.n(i),a=n(23645),r=n.n(a)()(s());r.push([t.id,"\n.task-list-item[data-v-607c7432] {\n\tborder: 1px solid #dadada;\n\tbackground-color: var(--color-main-background);\n\tborder-radius: 16px;\n}\n@media (max-width: 540px) {\n.badge[data-v-607c7432] {\n\t\tmargin-right: 0;\n\t\tmargin-bottom: 10px;\n}\n}\n","",{version:3,sources:["webpack://./src/components/tasks/TasksListItem.vue"],names:[],mappings:";AAwHA;CACA,yBAAA;CACA,8CAAA;CACA,mBAAA;AACA;AAEA;AACA;EACA,eAAA;EACA,mBAAA;AACA;AACA",sourcesContent:["\x3c!--\n - @copyright Copyright (c) 2022 Andrey Borysenko <andrey18106x@gmail.com>\n -\n - @copyright Copyright (c) 2022 Alexander Piskun <bigcat88@icloud.com>\n -\n - @author 2022 Andrey Borysenko <andrey18106x@gmail.com>\n -\n - @license AGPL-3.0-or-later\n -\n - This program is free software: you can redistribute it and/or modify\n - it under the terms of the GNU Affero General Public License as\n - published by the Free Software Foundation, either version 3 of the\n - License, or (at your option) any later version.\n -\n - This program is distributed in the hope that it will be useful,\n - but WITHOUT ANY WARRANTY; without even the implied warranty of\n - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n - GNU Affero General Public License for more details.\n -\n - You should have received a copy of the GNU Affero General Public License\n - along with this program. If not, see <http://www.gnu.org/licenses/>.\n -\n --\x3e\n\n<template>\n\t<NcListItem :title=\"listItemTitle\"\n\t\t:bold=\"true\"\n\t\t:force-display-actions=\"true\"\n\t\t:to=\"{ name: 'collectorDetails', params: { taskId: task.id } }\"\n\t\tclass=\"task-list-item\">\n\t\t<template #icon>\n\t\t\t<span :class=\"'badge ' + getStatusBadge(task)\">{{ getStatusBadge(task) }}</span>\n\t\t</template>\n\t\t<template #subtitle>\n\t\t\t{{ listItemDetails }}\n\t\t\t<NcProgressBar :value=\"Math.round((task.files_scanned / task.files_total) * 100)\"\n\t\t\t\tsize=\"small\"\n\t\t\t\t:error=\"getStatusBadge(task) === 'error'\" />\n\t\t</template>\n\t\t<template #actions>\n\t\t\t<NcActionButton icon=\"icon-history\" :close-after-click=\"true\" @click=\"restartTask(task)\">\n\t\t\t\t{{ getStatusBadge(task) === 'duplicated' ? t('mediadc', 'Start') : t('mediadc', 'Restart') }}\n\t\t\t</NcActionButton>\n\t\t\t<NcActionButton icon=\"icon-pause\" :close-after-click=\"true\" @click=\"terminateTask(task)\">\n\t\t\t\t{{ t('mediadc', 'Stop') }}\n\t\t\t</NcActionButton>\n\t\t\t<NcActionButton v-tooltip=\"{content: t('mediadc', 'Create copy of the task'), placement: 'left'}\"\n\t\t\t\t:close-after-click=\"true\"\n\t\t\t\t@click=\"duplicateTask(task)\">\n\t\t\t\t{{ t('mediadc', 'Duplicate') }}\n\t\t\t\t<template #icon>\n\t\t\t\t\t<ContentCopy :size=\"16\" />\n\t\t\t\t</template>\n\t\t\t</NcActionButton>\n\t\t\t<NcActionButton icon=\"icon-delete\" :close-after-click=\"true\" @click=\"deleteTask(task)\">\n\t\t\t\t{{ t('mediadc', 'Delete') }}\n\t\t\t</NcActionButton>\n\t\t</template>\n\t</NcListItem>\n</template>\n\n<script>\nimport { mapActions, mapGetters } from 'vuex'\n\nimport NcActionButton from '@nextcloud/vue/dist/Components/NcActionButton.js'\nimport ContentCopy from 'vue-material-design-icons/ContentCopy.vue'\nimport NcProgressBar from '@nextcloud/vue/dist/Components/NcProgressBar.js'\nimport NcListItem from '@nextcloud/vue/dist/Components/NcListItem.js'\n\nimport Formats from '../../mixins/Formats.js'\n\nexport default {\n\tname: 'TasksListItem',\n\tcomponents: {\n\t\tNcActionButton,\n\t\tContentCopy,\n\t\tNcListItem,\n\t\tNcProgressBar,\n\t},\n\tmixins: [Formats],\n\tprops: {\n\t\ttask: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\t...mapGetters([\n\t\t\t'tasks',\n\t\t]),\n\t\tlistItemTitle() {\n\t\t\treturn `${this.parseTargetMtype(this.task)}\n\t\t\t\t${this.task.files_scanned !== this.task.files_total ? this.task.files_scanned + '/' : ''}${this.task.files_total} ${this.n('mediadc', 'file', 'files', this.task.files_total)}\n\t\t\t\t(${this.formatBytes(Number(this.task.files_total_size))})`\n\t\t},\n\t\tlistItemDetails() {\n\t\t\treturn `${this.parseUnixTimestamp(this.task.created_time)}\n\t\t\t\t${Number(this.task.finished_time) > 0 ? ' - ' + this.parseUnixTimestamp(this.task.finished_time) : ''}`\n\t\t},\n\t},\n\tmethods: {\n\t\t...mapActions([\n\t\t\t'getTasks',\n\t\t\t'getSettings',\n\t\t\t'deleteTask',\n\t\t\t'duplicateTask',\n\t\t\t'terminateTask',\n\t\t\t'restartTask',\n\t\t]),\n\t},\n}\n<\/script>\n\n<style>\n.list-item {\n\tmargin: 0 !important;\n}\n</style>\n\n<style scoped>\n.task-list-item {\n\tborder: 1px solid #dadada;\n\tbackground-color: var(--color-main-background);\n\tborder-radius: 16px;\n}\n\n@media (max-width: 540px) {\n\t.badge {\n\t\tmargin-right: 0;\n\t\tmargin-bottom: 10px;\n\t}\n}\n</style>\n"],sourceRoot:""}]);const o=r},31675:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});var i=n(87537),s=n.n(i),a=n(23645),r=n.n(a)()(s());r.push([t.id,"\n.new-task-block[data-v-7c419aa3] {\n\tborder: 1px solid var(--color-border-dark);\n\tborder-radius: var(--border-radius-large);\n\tbox-shadow: 0 0 4px 0 rgba(0, 0, 0, .05);\n\tpadding: 20px 20px 10px;\n\tmargin: 10px;\n\twidth: 100%;\n\tmax-width: 600px;\n}\nbody[data-theme-dark] .new-task-block[data-v-7c419aa3] {\n\tborder-color: var(--color-border-dark);\n}\n@media (max-width: 767px) {\n.selection-container[data-v-7c419aa3] {\n\t\tflex-wrap: wrap;\n}\n}\n.create-task-actions[data-v-7c419aa3] {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: space-between;\n\tmargin-top: 5px;\n\tpadding: 0 10px;\n}\n@media (max-width: 480px) {\n.create-task-actions[data-v-7c419aa3] {\n\t\tflex-direction: column;\n}\n.create-task-actions button[data-v-7c419aa3] {\n\t\tmargin-bottom: 10px;\n}\n}\n","",{version:3,sources:["webpack://./src/components/tasks/TasksNew.vue"],names:[],mappings:";AAoZA;CACA,0CAAA;CACA,yCAAA;CACA,wCAAA;CACA,uBAAA;CACA,YAAA;CACA,WAAA;CACA,gBAAA;AACA;AAEA;CACA,sCAAA;AACA;AAEA;AACA;EACA,eAAA;AACA;AACA;AAEA;CACA,aAAA;CACA,mBAAA;CACA,8BAAA;CACA,eAAA;CACA,eAAA;AACA;AAEA;AACA;EACA,sBAAA;AACA;AAEA;EACA,mBAAA;AACA;AACA",sourcesContent:["\x3c!--\n - @copyright Copyright (c) 2021 Andrey Borysenko <andrey18106x@gmail.com>\n -\n - @copyright Copyright (c) 2021 Alexander Piskun <bigcat88@icloud.com>\n -\n - @author Andrey Borysenko <andrey18106x@gmail.com>\n -\n - @license AGPL-3.0-or-later\n -\n - This program is free software: you can redistribute it and/or modify\n - it under the terms of the GNU Affero General Public License as\n - published by the Free Software Foundation, either version 3 of the\n - License, or (at your option) any later version.\n -\n - This program is distributed in the hope that it will be useful,\n - but WITHOUT ANY WARRANTY; without even the implied warranty of\n - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n - GNU Affero General Public License for more details.\n -\n - You should have received a copy of the GNU Affero General Public License\n - along with this program. If not, see <http://www.gnu.org/licenses/>.\n -\n --\x3e\n\n<template>\n\t<div class=\"new-task-block\">\n\t\t<h2>{{ t('mediadc', 'Create a new Task') }}</h2>\n\t\t<div class=\"selection-container\">\n\t\t\t<div class=\"block target-directories-block\">\n\t\t\t\t<h3>{{ t('mediadc', 'Target directories') }}</h3>\n\t\t\t\t<div v-if=\"targetDirectoriesIds.length > 0\">\n\t\t\t\t\t<div v-for=\"fileid in targetDirectoriesIds\" :key=\"fileid\" class=\"selected-target-directories-list\">\n\t\t\t\t\t\t<div class=\"target-directory\">\n\t\t\t\t\t\t\t<span :title=\"targetDirectoriesPaths[fileid]\"\n\t\t\t\t\t\t\t\tstyle=\"overflow-y: scroll; white-space: nowrap;\">\n\t\t\t\t\t\t\t\t{{ targetDirectoriesPaths[fileid] }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<NcButton v-tooltip=\"{ content: t('mediadc', 'Remove'), placement: 'left'}\"\n\t\t\t\t\t\t\t\ttype=\"tertiary\"\n\t\t\t\t\t\t\t\t:aria-label=\"t('mediadc', 'Remove selected target directory')\"\n\t\t\t\t\t\t\t\t@click=\"removeTargetDirectory(fileid)\">\n\t\t\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t\t\t<span class=\"icon-delete\" />\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t</NcButton>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-else>\n\t\t\t\t\t<span>{{ t('mediadc', 'Not selected') }}</span>\n\t\t\t\t</div>\n\t\t\t\t<br>\n\t\t\t\t<NcButton class=\"mediadc-button-vue\"\n\t\t\t\t\t:aria-label=\"t('mediadc', 'Select target directory')\"\n\t\t\t\t\t@click=\"openDirectoriesExplorer\">\n\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t<PlusThick :size=\"16\" />\n\t\t\t\t\t</template>\n\t\t\t\t\t{{ t('mediadc', 'Select') }}\n\t\t\t\t</NcButton>\n\t\t\t</div>\n\t\t\t<div class=\"block\">\n\t\t\t\t<h3>{{ t('mediadc', 'Exclude directories') }}</h3>\n\t\t\t\t<div v-if=\"excludeDirectoriesPaths.length > 0\">\n\t\t\t\t\t<div v-for=\"fileid in Object.keys(excludeFileIds)\" :key=\"fileid\" class=\"selected-excluded-directories-list\">\n\t\t\t\t\t\t<div class=\"target-directory\">\n\t\t\t\t\t\t\t<span :title=\"excludeFileIds[fileid]\"\n\t\t\t\t\t\t\t\tstyle=\"overflow-y: scroll; white-space: nowrap;\">\n\t\t\t\t\t\t\t\t{{ excludeFileIds[fileid] }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<NcButton v-tooltip=\"{ content: t('mediadc', 'Remove'), placement: 'left'}\"\n\t\t\t\t\t\t\t\ttype=\"tertiary\"\n\t\t\t\t\t\t\t\t:aria-label=\"t('mediadc', 'Remove selected exclude directory')\"\n\t\t\t\t\t\t\t\t@click=\"removeExcludeDirectory(fileid)\">\n\t\t\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t\t\t<span class=\"icon-delete\" />\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t</NcButton>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-else>\n\t\t\t\t\t<span>{{ t('mediadc', 'Not selected') }}</span>\n\t\t\t\t</div>\n\t\t\t\t<br>\n\t\t\t\t<NcButton class=\"mediadc-button-vue\"\n\t\t\t\t\t:aria-label=\"t('mediadc', 'Select exclude directory')\"\n\t\t\t\t\t@click=\"openExcludeExplorer\">\n\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t<PlusThick :size=\"16\" />\n\t\t\t\t\t</template>\n\t\t\t\t\t{{ t('mediadc', 'Select') }}\n\t\t\t\t</NcButton>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"selection-container\">\n\t\t\t<div class=\"block\">\n\t\t\t\t<h3>{{ t('mediadc', 'Custom exclude mask') }}</h3>\n\t\t\t\t<div v-if=\"customExcludeList.length > 0\" class=\"custom-masks-list\">\n\t\t\t\t\t<div v-for=\"(mask, index) in customExcludeList\" :key=\"index\" class=\"custom-mask\">\n\t\t\t\t\t\t<span>{{ mask }}</span>\n\t\t\t\t\t\t<NcButton v-tooltip=\"{ content: t('mediadc', 'Remove'), placement: 'left'}\"\n\t\t\t\t\t\t\ttype=\"tertiary\"\n\t\t\t\t\t\t\t:aria-label=\"t('mediadc', 'Remove selected custom exclude mask')\"\n\t\t\t\t\t\t\t@click=\"deleteCustomMask(mask)\">\n\t\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t\t<span class=\"icon-delete\" />\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</NcButton>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-else>\n\t\t\t\t\t<span>{{ t('mediadc', 'Not added') }}</span>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"addingCustomMask\" style=\"display: flex; align-items: center;\">\n\t\t\t\t\t<input id=\"custom-exclude-mask\"\n\t\t\t\t\t\tref=\"customExcludeMask\"\n\t\t\t\t\t\tv-model=\"customExcludeMask\"\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t@keyup.enter=\"addCustomMask\"\n\t\t\t\t\t\t@keyup.esc=\"cancelAddingCustomMask\">\n\t\t\t\t\t<NcButton v-tooltip=\"t('mediadc', 'Confirm')\"\n\t\t\t\t\t\ttype=\"tertiary\"\n\t\t\t\t\t\t:aria-label=\"t('mediadc', 'Confirm adding of the custom exclude mask')\"\n\t\t\t\t\t\t@click=\"addCustomMask\">\n\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t<span class=\"icon-checkmark\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</NcButton>\n\t\t\t\t\t<NcButton v-tooltip=\"t('mediadc', 'Decline')\"\n\t\t\t\t\t\ttype=\"tertiary\"\n\t\t\t\t\t\t:aria-label=\"t('mediadc', 'Cancel adding of the custom exclude mask')\"\n\t\t\t\t\t\t@click=\"cancelAddingCustomMask\">\n\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t<span class=\"icon-close\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</NcButton>\n\t\t\t\t</div>\n\t\t\t\t<div style=\"display: flex; align-items: center; margin: 20px 0;\">\n\t\t\t\t\t<NcButton class=\"mediadc-button-vue\"\n\t\t\t\t\t\t:aria-label=\"t('mediadc', 'Add custom exclude mask')\"\n\t\t\t\t\t\t@click=\"addNewMask\">\n\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t<PlusThick :size=\"16\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<span>{{ t('mediadc', 'Add mask') }}</span>\n\t\t\t\t\t</NcButton>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"block\">\n\t\t\t\t<h3 style=\"margin: 5px 0;\">\n\t\t\t\t\t{{ t('mediadc', 'Target Mime Type') }}\n\t\t\t\t</h3>\n\t\t\t\t<select id=\"target_mtype\"\n\t\t\t\t\tv-model=\"targetMimeType\"\n\t\t\t\t\tname=\"target_mtype\">\n\t\t\t\t\t<option :value=\"0\">\n\t\t\t\t\t\t{{ t('mediadc', 'Photos') }}\n\t\t\t\t\t</option>\n\t\t\t\t\t<option :value=\"1\">\n\t\t\t\t\t\t{{ t('mediadc', 'Videos') }}\n\t\t\t\t\t</option>\n\t\t\t\t\t<option :value=\"2\">\n\t\t\t\t\t\t{{ t('mediadc', 'Photos and Videos') }}\n\t\t\t\t\t</option>\n\t\t\t\t</select>\n\t\t\t\t<h3 style=\"margin: 5px 0;\">\n\t\t\t\t\t{{ t('mediadc', 'Similarity threshold') }}\n\t\t\t\t</h3>\n\t\t\t\t<input v-model=\"similarity_threshold\"\n\t\t\t\t\ttype=\"number\"\n\t\t\t\t\tmin=\"50\"\n\t\t\t\t\tmax=\"100\"\n\t\t\t\t\tstyle=\"margin: 0 0 10px;\">\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"create-task-actions\">\n\t\t\t<NcButton class=\"mediadc-button-vue\"\n\t\t\t\t:aria-label=\"t('mediadc', 'Create and Run new Task')\"\n\t\t\t\t:disabled=\"runningTask || Object.keys(targetDirectoriesPaths).length === 0\"\n\t\t\t\t@click=\"runCollectorTask\">\n\t\t\t\t<template #default>\n\t\t\t\t\t{{ t('mediadc', 'Run new Task') }}\n\t\t\t\t</template>\n\t\t\t\t<template v-if=\"runningTask\" #icon>\n\t\t\t\t\t<span class=\"icon-loading-small\" />\n\t\t\t\t</template>\n\t\t\t</NcButton>\n\t\t\t<NcCheckboxRadioSwitch v-tooltip=\"t('mediadc', 'Send notification on task finish')\"\n\t\t\t\t:checked.sync=\"finishNotification\">\n\t\t\t\t{{ t('mediadc', 'Finish notification') }}\n\t\t\t</NcCheckboxRadioSwitch>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport { getFilePickerBuilder, showWarning, showSuccess, showError } from '@nextcloud/dialogs'\nimport { mapActions, mapGetters } from 'vuex'\n\nimport { requestFileInfo, getFileId } from '../../utils/files.js'\n\nimport NcButton from '@nextcloud/vue/dist/Components/NcButton.js'\nimport NcCheckboxRadioSwitch from '@nextcloud/vue/dist/Components/NcCheckboxRadioSwitch.js'\nimport PlusThick from 'vue-material-design-icons/PlusThick.vue'\n\nexport default {\n\tname: 'TasksNew',\n\tcomponents: {\n\t\tNcButton,\n\t\tNcCheckboxRadioSwitch,\n\t\tPlusThick,\n\t},\n\tdata() {\n\t\treturn {\n\t\t\ttargetDirectoriesPaths: {},\n\t\t\ttargetDirectoriesIds: [],\n\t\t\texcludeDirectoriesPaths: [],\n\t\t\texcludeFileIds: {},\n\t\t\ttargetMimeType: 0,\n\t\t\tsimilarity_threshold: 90,\n\t\t\tcustomExcludeList: [],\n\t\t\tcustomExcludeMask: '',\n\t\t\taddingCustomMask: false,\n\t\t\trunningTask: false,\n\t\t\tfinishNotification: true,\n\t\t}\n\t},\n\tcomputed: {\n\t\t...mapGetters([\n\t\t\t'settings',\n\t\t\t'settingByName',\n\t\t\t'tasks',\n\t\t]),\n\t},\n\tbeforeMount() {\n\t\tthis.similarity_threshold = this.settingByName('similarity_threshold') !== undefined\n\t\t\t? this.settingByName('similarity_threshold').value\n\t\t\t: 90\n\t},\n\tmethods: {\n\t\t...mapActions(['runTask', 'getTasks']),\n\t\tgetDirectoriesPicker(title) {\n\t\t\treturn getFilePickerBuilder(title)\n\t\t\t\t.setMultiSelect(false)\n\t\t\t\t.addMimeTypeFilter('httpd/unix-directory')\n\t\t\t\t.setModal(true)\n\t\t\t\t.setType(1)\n\t\t\t\t.allowDirectories(true)\n\t\t\t\t.build()\n\t\t},\n\t\tgetFilesPicker(title) {\n\t\t\treturn getFilePickerBuilder(title)\n\t\t\t\t.setMultiSelect(false)\n\t\t\t\t.setModal(true)\n\t\t\t\t.setType(1)\n\t\t\t\t.allowDirectories(true)\n\t\t\t\t.build()\n\t\t},\n\t\topenDirectoriesExplorer() {\n\t\t\tthis.getDirectoriesPicker(this.t('mediadc', 'Choose target directory')).pick().then(dir => {\n\t\t\t\tif (dir.startsWith('/')) {\n\t\t\t\t\trequestFileInfo(dir).then(res => {\n\t\t\t\t\t\tconst fileid = getFileId(res.data)\n\t\t\t\t\t\tif (fileid !== -1) {\n\t\t\t\t\t\t\tif (!(fileid in this.targetDirectoriesPaths)) {\n\t\t\t\t\t\t\t\tthis.targetDirectoriesIds.push(fileid)\n\t\t\t\t\t\t\t\tthis.targetDirectoriesPaths[fileid.toString()] = dir\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tshowWarning(this.t('mediadc', 'This directory already selected'))\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t} else {\n\t\t\t\t\trequestFileInfo('/').then(res => {\n\t\t\t\t\t\tconst fileid = getFileId(res.data)\n\t\t\t\t\t\tif (fileid !== -1) {\n\t\t\t\t\t\t\tif (!(fileid in this.targetDirectoriesPaths)) {\n\t\t\t\t\t\t\t\tthis.targetDirectoriesIds.push(fileid)\n\t\t\t\t\t\t\t\tthis.targetDirectoriesPaths[fileid.toString()] = '/'\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tshowWarning(this.t('mediadc', 'This directory already selected'))\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\topenExcludeExplorer() {\n\t\t\tthis.getDirectoriesPicker(this.t('mediadc', 'Choose directory to exclude')).pick().then(dir => {\n\t\t\t\tif (Object.values(this.excludeFileIds).findIndex(targetDir => targetDir === dir) === -1) {\n\t\t\t\t\tif (dir.startsWith('/')) {\n\t\t\t\t\t\trequestFileInfo(dir).then(res => {\n\t\t\t\t\t\t\tconst fileid = getFileId(res.data)\n\t\t\t\t\t\t\tif (fileid !== -1) {\n\t\t\t\t\t\t\t\tthis.excludeDirectoriesPaths.push(dir)\n\t\t\t\t\t\t\t\tthis.excludeFileIds[fileid.toString()] = dir\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t} else {\n\t\t\t\t\t\trequestFileInfo('/').then(res => {\n\t\t\t\t\t\t\tconst fileid = getFileId(res.data)\n\t\t\t\t\t\t\tif (fileid !== -1) {\n\t\t\t\t\t\t\t\tthis.excludeDirectoriesPaths.push(dir)\n\t\t\t\t\t\t\t\tthis.excludeFileIds[fileid.toString()] = '/'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tshowWarning(this.t('mediadc', 'This directory already excluded'))\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\trunCollectorTask() {\n\t\t\tthis.runningTask = true\n\t\t\tthis.runTask({\n\t\t\t\ttargetDirectoryIds: JSON.stringify(this.targetDirectoriesIds),\n\t\t\t\texcludeList: {\n\t\t\t\t\tuser: {\n\t\t\t\t\t\tmask: this.customExcludeList,\n\t\t\t\t\t\tfileid: Object.keys(this.excludeFileIds).map(item => Number(item)),\n\t\t\t\t\t},\n\t\t\t\t\tadmin: JSON.parse(this.settingByName('exclude_list').value) || { mask: [], fileid: [] },\n\t\t\t\t},\n\t\t\t\tcollectorSettings: {\n\t\t\t\t\thashing_algorithm: JSON.parse(this.settingByName('hashing_algorithm').value) || 'dhash',\n\t\t\t\t\tsimilarity_threshold: this.similarity_threshold,\n\t\t\t\t\thash_size: this.settingByName('hash_size').value || 16,\n\t\t\t\t\ttarget_mtype: this.targetMimeType,\n\t\t\t\t\tfinish_notification: this.finishNotification,\n\t\t\t\t},\n\t\t\t}).then(res => {\n\t\t\t\tthis.runningTask = false\n\t\t\t\tif (res.data.success) {\n\t\t\t\t\tthis.getTasks()\n\t\t\t\t\tthis.resetForm()\n\t\t\t\t\tshowSuccess(this.t('mediadc', 'New task successfully created!'))\n\t\t\t\t} else if (res.data.limit) {\n\t\t\t\t\tshowWarning(this.t('mediadc', 'Running tasks limit exceed. Try again later.'))\n\t\t\t\t} else if (res.data.empty) {\n\t\t\t\t\tshowWarning(this.n('mediadc', 'Target folder has no files or all of them excluded', 'Target folders have no files or all of them excluded', this.targetDirectoriesIds.length))\n\t\t\t\t} else if (res.data.php_exec_not_enabled) {\n\t\t\t\t\tshowError(t('mediadc', 'Task run error: PHP `exec` function is not enabled'))\n\t\t\t\t} else {\n\t\t\t\t\tshowWarning(t('medaidc', 'Some error occurred while running Collector Task. Try again.'))\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\tremoveTargetDirectory(fileid) {\n\t\t\tdelete this.targetDirectoriesPaths[fileid]\n\t\t\tconst fileidIndex = this.targetDirectoriesIds.findIndex(id => id === fileid)\n\t\t\tthis.targetDirectoriesIds.splice(fileidIndex, 1)\n\t\t},\n\t\tremoveExcludeDirectory(fileid) {\n\t\t\tif (fileid in this.excludeFileIds) {\n\t\t\t\tconst dirIndex = this.excludeDirectoriesPaths.findIndex(dir => dir === this.excludeFileIds[fileid])\n\t\t\t\tthis.excludeDirectoriesPaths.splice(dirIndex, 1)\n\t\t\t\tdelete this.excludeFileIds[fileid]\n\t\t\t}\n\t\t},\n\t\taddNewMask() {\n\t\t\tthis.addingCustomMask = true\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.$refs.customExcludeMask.focus()\n\t\t\t}, 100)\n\t\t},\n\t\taddCustomMask() {\n\t\t\tif (this.customExcludeMask.length > 0) {\n\t\t\t\tif (this.customExcludeList.findIndex(mask => mask === this.customExcludeMask) === -1) {\n\t\t\t\t\tthis.customExcludeList.push(this.customExcludeMask)\n\t\t\t\t\tthis.customExcludeMask = ''\n\t\t\t\t\tthis.addingCustomMask = false\n\t\t\t\t} else {\n\t\t\t\t\tshowWarning(this.t('mediadc', 'This mask already exists!'))\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tshowWarning(this.t('mediadc', 'Enter custom mask!'))\n\t\t\t}\n\t\t},\n\t\tcancelAddingCustomMask() {\n\t\t\tthis.customExcludeMask = ''\n\t\t\tthis.addingCustomMask = false\n\t\t},\n\t\tdeleteCustomMask(mask) {\n\t\t\tconst maskIndex = this.customExcludeList.findIndex(m => m === mask)\n\t\t\tthis.customExcludeList.splice(maskIndex, 1)\n\t\t},\n\t\tresetForm() {\n\t\t\tthis.targetDirectoriesPaths = {}\n\t\t\tthis.targetDirectoriesIds = []\n\t\t\tthis.excludeDirectoriesPaths = []\n\t\t\tthis.excludeFileIds = {}\n\t\t\tthis.targetMimeType = 0\n\t\t\tthis.similarity_threshold = this.settingByName('similarity_threshold') !== undefined\n\t\t\t\t? this.settingByName('similarity_threshold').value\n\t\t\t\t: 90\n\t\t\tthis.customExcludeList = []\n\t\t\tthis.runningTask = false\n\t\t},\n\t},\n}\n<\/script>\n\n<style scoped>\n.new-task-block {\n\tborder: 1px solid var(--color-border-dark);\n\tborder-radius: var(--border-radius-large);\n\tbox-shadow: 0 0 4px 0 rgba(0, 0, 0, .05);\n\tpadding: 20px 20px 10px;\n\tmargin: 10px;\n\twidth: 100%;\n\tmax-width: 600px;\n}\n\nbody[data-theme-dark] .new-task-block {\n\tborder-color: var(--color-border-dark);\n}\n\n@media (max-width: 767px) {\n\t.selection-container {\n\t\tflex-wrap: wrap;\n\t}\n}\n\n.create-task-actions {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: space-between;\n\tmargin-top: 5px;\n\tpadding: 0 10px;\n}\n\n@media (max-width: 480px) {\n\t.create-task-actions {\n\t\tflex-direction: column;\n\t}\n\n\t.create-task-actions button {\n\t\tmargin-bottom: 10px;\n\t}\n}\n</style>\n"],sourceRoot:""}]);const o=r},39201:(t,e,n)=>{"use strict";n.d(e,{Z:()=>o});var i=n(87537),s=n.n(i),a=n(23645),r=n.n(a)()(s());r.push([t.id,"\n.container[data-v-9e4bd412] {\n\tpadding: 0 20px;\n\twidth: 100%;\n\tmax-width: 1440px;\n\tmargin: 0 auto;\n}\nh2[data-v-9e4bd412] {\n\tfont-size: 24px;\n\tfont-weight: bold;\n\ttext-align: center;\n\tmargin: 20px 0 10px;\n}\np[data-v-9e4bd412] {\n\tpadding: 0 10px;\n\tmargin: 10px 0;\n\ttext-align: center;\n}\n.mediadc-row[data-v-9e4bd412] {\n\tdisplay: flex;\n\tjustify-content: center;\n}\n@media (max-width: 960px) {\n.mediadc-row[data-v-9e4bd412] {\n\t\tflex-wrap: wrap;\n}\n}\n","",{version:3,sources:["webpack://./src/views/Collector.vue"],names:[],mappings:";AA6EA;CACA,eAAA;CACA,WAAA;CACA,iBAAA;CACA,cAAA;AACA;AAEA;CACA,eAAA;CACA,iBAAA;CACA,kBAAA;CACA,mBAAA;AACA;AAEA;CACA,eAAA;CACA,cAAA;CACA,kBAAA;AACA;AAEA;CACA,aAAA;CACA,uBAAA;AACA;AAEA;AACA;EACA,eAAA;AACA;AACA",sourcesContent:["\x3c!--\n - @copyright Copyright (c) 2021-2022 Andrey Borysenko <andrey18106x@gmail.com>\n -\n - @copyright Copyright (c) 2021-2022 Alexander Piskun <bigcat88@icloud.com>\n -\n - @author 2021-2022 Andrey Borysenko <andrey18106x@gmail.com>\n -\n - @license AGPL-3.0-or-later\n -\n - This program is free software: you can redistribute it and/or modify\n - it under the terms of the GNU Affero General Public License as\n - published by the Free Software Foundation, either version 3 of the\n - License, or (at your option) any later version.\n -\n - This program is distributed in the hope that it will be useful,\n - but WITHOUT ANY WARRANTY; without even the implied warranty of\n - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n - GNU Affero General Public License for more details.\n -\n - You should have received a copy of the GNU Affero General Public License\n - along with this program. If not, see <http://www.gnu.org/licenses/>.\n -\n --\x3e\n\n<template>\n\t<div v-if=\"!loading\" class=\"container\">\n\t\t<div class=\"heading\">\n\t\t\t<h2>{{ rootTitle }}</h2>\n\t\t\t<p>\n\t\t\t\t{{ t('mediadc', 'Welcome to Media Duplicate Collector (MediaDC). ') }}\n\t\t\t\t{{ t('mediadc', 'Here you can manage your duplicate collection tasks and ') }}\n\t\t\t\t{{ t('mediadc', 'see the history of previous finished tasks.') }}\n\t\t\t</p>\n\t\t</div>\n\t\t<div class=\"mediadc-row\">\n\t\t\t<TasksNew />\n\t\t\t<TasksList />\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport TasksNew from '../components/tasks/TasksNew.vue'\nimport TasksList from '../components/tasks/TasksList.vue'\n\nexport default {\n\tname: 'Collector',\n\tcomponents: {\n\t\tTasksNew,\n\t\tTasksList,\n\t},\n\tprops: {\n\t\trootTitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tloading: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tupdating: false,\n\t\t}\n\t},\n\tbeforeMount() {\n\t\tthis.$store.dispatch('getTasks', true).then(() => {\n\t\t\tthis.$store.dispatch('getSettings').then(() => {\n\t\t\t\tthis.$emit('update:loading', false)\n\t\t\t})\n\t\t})\n\t},\n}\n<\/script>\n\n<style scoped>\n.container {\n\tpadding: 0 20px;\n\twidth: 100%;\n\tmax-width: 1440px;\n\tmargin: 0 auto;\n}\n\nh2 {\n\tfont-size: 24px;\n\tfont-weight: bold;\n\ttext-align: center;\n\tmargin: 20px 0 10px;\n}\n\np {\n\tpadding: 0 10px;\n\tmargin: 10px 0;\n\ttext-align: center;\n}\n\n.mediadc-row {\n\tdisplay: flex;\n\tjustify-content: center;\n}\n\n@media (max-width: 960px) {\n\t.mediadc-row {\n\t\tflex-wrap: wrap;\n\t}\n}\n</style>\n"],sourceRoot:""}]);const o=r},38357:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var i=n(4572),s=n(99889);const a=(0,n(51900).Z)(s.Z,i.s,i.x,!1,null,null,null).exports},83502:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});const i={name:"ContentCopyIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}}},18516:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var i=n(31829),s=n(38721);const a=(0,n(51900).Z)(s.Z,i.s,i.x,!1,null,null,null).exports},89923:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});const i={name:"PlusThickIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}}},63715:(e,n,i)=>{"use strict";i.r(n),i.d(n,{default:()=>rt});var s=i(82880),a=i(20629),r=i(88982),o=i(10861),c=i.n(o),l=i(20571),d=i.n(l),u=i(18516);function m(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function p(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?m(Object(n),!0).forEach((function(e){h(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function h(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const A={name:"TasksNew",components:{NcButton:c(),NcCheckboxRadioSwitch:d(),PlusThick:u.Z},data:function(){return{targetDirectoriesPaths:{},targetDirectoriesIds:[],excludeDirectoriesPaths:[],excludeFileIds:{},targetMimeType:0,similarity_threshold:90,customExcludeList:[],customExcludeMask:"",addingCustomMask:!1,runningTask:!1,finishNotification:!0}},computed:p({},(0,a.Se)(["settings","settingByName","tasks"])),beforeMount:function(){this.similarity_threshold=void 0!==this.settingByName("similarity_threshold")?this.settingByName("similarity_threshold").value:90},methods:p(p({},(0,a.nv)(["runTask","getTasks"])),{},{getDirectoriesPicker:function(t){return(0,s.getFilePickerBuilder)(t).setMultiSelect(!1).addMimeTypeFilter("httpd/unix-directory").setModal(!0).setType(1).allowDirectories(!0).build()},getFilesPicker:function(t){return(0,s.getFilePickerBuilder)(t).setMultiSelect(!1).setModal(!0).setType(1).allowDirectories(!0).build()},openDirectoriesExplorer:function(){var t=this;this.getDirectoriesPicker(this.t("mediadc","Choose target directory")).pick().then((function(e){e.startsWith("/")?(0,r.zW)(e).then((function(n){var i=(0,r.WU)(n.data);-1!==i&&(i in t.targetDirectoriesPaths?(0,s.showWarning)(t.t("mediadc","This directory already selected")):(t.targetDirectoriesIds.push(i),t.targetDirectoriesPaths[i.toString()]=e))})):(0,r.zW)("/").then((function(e){var n=(0,r.WU)(e.data);-1!==n&&(n in t.targetDirectoriesPaths?(0,s.showWarning)(t.t("mediadc","This directory already selected")):(t.targetDirectoriesIds.push(n),t.targetDirectoriesPaths[n.toString()]="/"))}))}))},openExcludeExplorer:function(){var t=this;this.getDirectoriesPicker(this.t("mediadc","Choose directory to exclude")).pick().then((function(e){-1===Object.values(t.excludeFileIds).findIndex((function(t){return t===e}))?e.startsWith("/")?(0,r.zW)(e).then((function(n){var i=(0,r.WU)(n.data);-1!==i&&(t.excludeDirectoriesPaths.push(e),t.excludeFileIds[i.toString()]=e)})):(0,r.zW)("/").then((function(n){var i=(0,r.WU)(n.data);-1!==i&&(t.excludeDirectoriesPaths.push(e),t.excludeFileIds[i.toString()]="/")})):(0,s.showWarning)(t.t("mediadc","This directory already excluded"))}))},runCollectorTask:function(){var e=this;this.runningTask=!0,this.runTask({targetDirectoryIds:JSON.stringify(this.targetDirectoriesIds),excludeList:{user:{mask:this.customExcludeList,fileid:Object.keys(this.excludeFileIds).map((function(t){return Number(t)}))},admin:JSON.parse(this.settingByName("exclude_list").value)||{mask:[],fileid:[]}},collectorSettings:{hashing_algorithm:JSON.parse(this.settingByName("hashing_algorithm").value)||"dhash",similarity_threshold:this.similarity_threshold,hash_size:this.settingByName("hash_size").value||16,target_mtype:this.targetMimeType,finish_notification:this.finishNotification}}).then((function(n){e.runningTask=!1,n.data.success?(e.getTasks(),e.resetForm(),(0,s.showSuccess)(e.t("mediadc","New task successfully created!"))):n.data.limit?(0,s.showWarning)(e.t("mediadc","Running tasks limit exceed. Try again later.")):n.data.empty?(0,s.showWarning)(e.n("mediadc","Target folder has no files or all of them excluded","Target folders have no files or all of them excluded",e.targetDirectoriesIds.length)):n.data.php_exec_not_enabled?(0,s.showError)(t("mediadc","Task run error: PHP `exec` function is not enabled")):(0,s.showWarning)(t("medaidc","Some error occurred while running Collector Task. Try again."))}))},removeTargetDirectory:function(t){delete this.targetDirectoriesPaths[t];var e=this.targetDirectoriesIds.findIndex((function(e){return e===t}));this.targetDirectoriesIds.splice(e,1)},removeExcludeDirectory:function(t){var e=this;if(t in this.excludeFileIds){var n=this.excludeDirectoriesPaths.findIndex((function(n){return n===e.excludeFileIds[t]}));this.excludeDirectoriesPaths.splice(n,1),delete this.excludeFileIds[t]}},addNewMask:function(){var t=this;this.addingCustomMask=!0,setTimeout((function(){t.$refs.customExcludeMask.focus()}),100)},addCustomMask:function(){var t=this;this.customExcludeMask.length>0?-1===this.customExcludeList.findIndex((function(e){return e===t.customExcludeMask}))?(this.customExcludeList.push(this.customExcludeMask),this.customExcludeMask="",this.addingCustomMask=!1):(0,s.showWarning)(this.t("mediadc","This mask already exists!")):(0,s.showWarning)(this.t("mediadc","Enter custom mask!"))},cancelAddingCustomMask:function(){this.customExcludeMask="",this.addingCustomMask=!1},deleteCustomMask:function(t){var e=this.customExcludeList.findIndex((function(e){return e===t}));this.customExcludeList.splice(e,1)},resetForm:function(){this.targetDirectoriesPaths={},this.targetDirectoriesIds=[],this.excludeDirectoriesPaths=[],this.excludeFileIds={},this.targetMimeType=0,this.similarity_threshold=void 0!==this.settingByName("similarity_threshold")?this.settingByName("similarity_threshold").value:90,this.customExcludeList=[],this.runningTask=!1}})};var f=i(93379),g=i.n(f),v=i(7795),k=i.n(v),y=i(90569),x=i.n(y),C=i(3565),b=i.n(C),w=i(19216),_=i.n(w),T=i(44589),N=i.n(T),B=i(31675),P={};P.styleTagTransform=N(),P.setAttributes=b(),P.insert=x().bind(null,"head"),P.domAPI=k(),P.insertStyleElement=_();g()(B.Z,P);B.Z&&B.Z.locals&&B.Z.locals;var I=i(51900);const S=(0,I.Z)(A,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"new-task-block"},[e("h2",[t._v(t._s(t.t("mediadc","Create a new Task")))]),t._v(" "),e("div",{staticClass:"selection-container"},[e("div",{staticClass:"block target-directories-block"},[e("h3",[t._v(t._s(t.t("mediadc","Target directories")))]),t._v(" "),t.targetDirectoriesIds.length>0?e("div",t._l(t.targetDirectoriesIds,(function(n){return e("div",{key:n,staticClass:"selected-target-directories-list"},[e("div",{staticClass:"target-directory"},[e("span",{staticStyle:{"overflow-y":"scroll","white-space":"nowrap"},attrs:{title:t.targetDirectoriesPaths[n]}},[t._v("\n\t\t\t\t\t\t\t"+t._s(t.targetDirectoriesPaths[n])+"\n\t\t\t\t\t\t")]),t._v(" "),e("NcButton",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:t.t("mediadc","Remove"),placement:"left"},expression:"{ content: t('mediadc', 'Remove'), placement: 'left'}"}],attrs:{type:"tertiary","aria-label":t.t("mediadc","Remove selected target directory")},on:{click:function(e){return t.removeTargetDirectory(n)}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("span",{staticClass:"icon-delete"})]},proxy:!0}],null,!0)})],1)])})),0):e("div",[e("span",[t._v(t._s(t.t("mediadc","Not selected")))])]),t._v(" "),e("br"),t._v(" "),e("NcButton",{staticClass:"mediadc-button-vue",attrs:{"aria-label":t.t("mediadc","Select target directory")},on:{click:t.openDirectoriesExplorer},scopedSlots:t._u([{key:"icon",fn:function(){return[e("PlusThick",{attrs:{size:16}})]},proxy:!0}])},[t._v("\n\t\t\t\t"+t._s(t.t("mediadc","Select"))+"\n\t\t\t")])],1),t._v(" "),e("div",{staticClass:"block"},[e("h3",[t._v(t._s(t.t("mediadc","Exclude directories")))]),t._v(" "),t.excludeDirectoriesPaths.length>0?e("div",t._l(Object.keys(t.excludeFileIds),(function(n){return e("div",{key:n,staticClass:"selected-excluded-directories-list"},[e("div",{staticClass:"target-directory"},[e("span",{staticStyle:{"overflow-y":"scroll","white-space":"nowrap"},attrs:{title:t.excludeFileIds[n]}},[t._v("\n\t\t\t\t\t\t\t"+t._s(t.excludeFileIds[n])+"\n\t\t\t\t\t\t")]),t._v(" "),e("NcButton",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:t.t("mediadc","Remove"),placement:"left"},expression:"{ content: t('mediadc', 'Remove'), placement: 'left'}"}],attrs:{type:"tertiary","aria-label":t.t("mediadc","Remove selected exclude directory")},on:{click:function(e){return t.removeExcludeDirectory(n)}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("span",{staticClass:"icon-delete"})]},proxy:!0}],null,!0)})],1)])})),0):e("div",[e("span",[t._v(t._s(t.t("mediadc","Not selected")))])]),t._v(" "),e("br"),t._v(" "),e("NcButton",{staticClass:"mediadc-button-vue",attrs:{"aria-label":t.t("mediadc","Select exclude directory")},on:{click:t.openExcludeExplorer},scopedSlots:t._u([{key:"icon",fn:function(){return[e("PlusThick",{attrs:{size:16}})]},proxy:!0}])},[t._v("\n\t\t\t\t"+t._s(t.t("mediadc","Select"))+"\n\t\t\t")])],1)]),t._v(" "),e("div",{staticClass:"selection-container"},[e("div",{staticClass:"block"},[e("h3",[t._v(t._s(t.t("mediadc","Custom exclude mask")))]),t._v(" "),t.customExcludeList.length>0?e("div",{staticClass:"custom-masks-list"},t._l(t.customExcludeList,(function(n,i){return e("div",{key:i,staticClass:"custom-mask"},[e("span",[t._v(t._s(n))]),t._v(" "),e("NcButton",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:t.t("mediadc","Remove"),placement:"left"},expression:"{ content: t('mediadc', 'Remove'), placement: 'left'}"}],attrs:{type:"tertiary","aria-label":t.t("mediadc","Remove selected custom exclude mask")},on:{click:function(e){return t.deleteCustomMask(n)}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("span",{staticClass:"icon-delete"})]},proxy:!0}],null,!0)})],1)})),0):e("div",[e("span",[t._v(t._s(t.t("mediadc","Not added")))])]),t._v(" "),t.addingCustomMask?e("div",{staticStyle:{display:"flex","align-items":"center"}},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.customExcludeMask,expression:"customExcludeMask"}],ref:"customExcludeMask",attrs:{id:"custom-exclude-mask",type:"text"},domProps:{value:t.customExcludeMask},on:{keyup:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addCustomMask.apply(null,arguments)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.cancelAddingCustomMask.apply(null,arguments)}],input:function(e){e.target.composing||(t.customExcludeMask=e.target.value)}}}),t._v(" "),e("NcButton",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.t("mediadc","Confirm"),expression:"t('mediadc', 'Confirm')"}],attrs:{type:"tertiary","aria-label":t.t("mediadc","Confirm adding of the custom exclude mask")},on:{click:t.addCustomMask},scopedSlots:t._u([{key:"icon",fn:function(){return[e("span",{staticClass:"icon-checkmark"})]},proxy:!0}],null,!1,3443818620)}),t._v(" "),e("NcButton",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.t("mediadc","Decline"),expression:"t('mediadc', 'Decline')"}],attrs:{type:"tertiary","aria-label":t.t("mediadc","Cancel adding of the custom exclude mask")},on:{click:t.cancelAddingCustomMask},scopedSlots:t._u([{key:"icon",fn:function(){return[e("span",{staticClass:"icon-close"})]},proxy:!0}],null,!1,1218614841)})],1):t._e(),t._v(" "),e("div",{staticStyle:{display:"flex","align-items":"center",margin:"20px 0"}},[e("NcButton",{staticClass:"mediadc-button-vue",attrs:{"aria-label":t.t("mediadc","Add custom exclude mask")},on:{click:t.addNewMask},scopedSlots:t._u([{key:"icon",fn:function(){return[e("PlusThick",{attrs:{size:16}})]},proxy:!0}])},[t._v(" "),e("span",[t._v(t._s(t.t("mediadc","Add mask")))])])],1)]),t._v(" "),e("div",{staticClass:"block"},[e("h3",{staticStyle:{margin:"5px 0"}},[t._v("\n\t\t\t\t"+t._s(t.t("mediadc","Target Mime Type"))+"\n\t\t\t")]),t._v(" "),e("select",{directives:[{name:"model",rawName:"v-model",value:t.targetMimeType,expression:"targetMimeType"}],attrs:{id:"target_mtype",name:"target_mtype"},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.targetMimeType=e.target.multiple?n:n[0]}}},[e("option",{domProps:{value:0}},[t._v("\n\t\t\t\t\t"+t._s(t.t("mediadc","Photos"))+"\n\t\t\t\t")]),t._v(" "),e("option",{domProps:{value:1}},[t._v("\n\t\t\t\t\t"+t._s(t.t("mediadc","Videos"))+"\n\t\t\t\t")]),t._v(" "),e("option",{domProps:{value:2}},[t._v("\n\t\t\t\t\t"+t._s(t.t("mediadc","Photos and Videos"))+"\n\t\t\t\t")])]),t._v(" "),e("h3",{staticStyle:{margin:"5px 0"}},[t._v("\n\t\t\t\t"+t._s(t.t("mediadc","Similarity threshold"))+"\n\t\t\t")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.similarity_threshold,expression:"similarity_threshold"}],staticStyle:{margin:"0 0 10px"},attrs:{type:"number",min:"50",max:"100"},domProps:{value:t.similarity_threshold},on:{input:function(e){e.target.composing||(t.similarity_threshold=e.target.value)}}})])]),t._v(" "),e("div",{staticClass:"create-task-actions"},[e("NcButton",{staticClass:"mediadc-button-vue",attrs:{"aria-label":t.t("mediadc","Create and Run new Task"),disabled:t.runningTask||0===Object.keys(t.targetDirectoriesPaths).length},on:{click:t.runCollectorTask},scopedSlots:t._u([{key:"default",fn:function(){return[t._v("\n\t\t\t\t"+t._s(t.t("mediadc","Run new Task"))+"\n\t\t\t")]},proxy:!0},t.runningTask?{key:"icon",fn:function(){return[e("span",{staticClass:"icon-loading-small"})]},proxy:!0}:null],null,!0)}),t._v(" "),e("NcCheckboxRadioSwitch",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.t("mediadc","Send notification on task finish"),expression:"t('mediadc', 'Send notification on task finish')"}],attrs:{checked:t.finishNotification},on:{"update:checked":function(e){t.finishNotification=e}}},[t._v("\n\t\t\t"+t._s(t.t("mediadc","Finish notification"))+"\n\t\t")])],1)])}),[],!1,null,"7c419aa3",null).exports;var E=i(93455),D=i.n(E),M=i(85561),O=i(84440),L=i(45400),R=i.n(L),F=i(38357),j=i(48959),Z=i.n(j),U=i(12143),G=i.n(U);function W(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function z(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?W(Object(n),!0).forEach((function(e){$(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function $(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const H={name:"TasksListItem",components:{NcActionButton:R(),ContentCopy:F.Z,NcListItem:G(),NcProgressBar:Z()},mixins:[O.Z],props:{task:{type:Object,required:!0}},computed:z(z({},(0,a.Se)(["tasks"])),{},{listItemTitle:function(){return"".concat(this.parseTargetMtype(this.task),"\n\t\t\t\t").concat(this.task.files_scanned!==this.task.files_total?this.task.files_scanned+"/":"").concat(this.task.files_total," ").concat(this.n("mediadc","file","files",this.task.files_total),"\n\t\t\t\t(").concat(this.formatBytes(Number(this.task.files_total_size)),")")},listItemDetails:function(){return"".concat(this.parseUnixTimestamp(this.task.created_time),"\n\t\t\t\t").concat(Number(this.task.finished_time)>0?" - "+this.parseUnixTimestamp(this.task.finished_time):"")}}),methods:z({},(0,a.nv)(["getTasks","getSettings","deleteTask","duplicateTask","terminateTask","restartTask"]))};var Y=i(25680),V={};V.styleTagTransform=N(),V.setAttributes=b(),V.insert=x().bind(null,"head"),V.domAPI=k(),V.insertStyleElement=_();g()(Y.Z,V);Y.Z&&Y.Z.locals&&Y.Z.locals;var q=i(91144),J={};J.styleTagTransform=N(),J.setAttributes=b(),J.insert=x().bind(null,"head"),J.domAPI=k(),J.insertStyleElement=_();g()(q.Z,J);q.Z&&q.Z.locals&&q.Z.locals;function X(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function Q(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?X(Object(n),!0).forEach((function(e){K(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function K(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const tt={name:"TasksList",components:{TasksListItem:(0,I.Z)(H,(function(){var t=this,e=t._self._c;return e("NcListItem",{staticClass:"task-list-item",attrs:{title:t.listItemTitle,bold:!0,"force-display-actions":!0,to:{name:"collectorDetails",params:{taskId:t.task.id}}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("span",{class:"badge "+t.getStatusBadge(t.task)},[t._v(t._s(t.getStatusBadge(t.task)))])]},proxy:!0},{key:"subtitle",fn:function(){return[t._v("\n\t\t"+t._s(t.listItemDetails)+"\n\t\t"),e("NcProgressBar",{attrs:{value:Math.round(t.task.files_scanned/t.task.files_total*100),size:"small",error:"error"===t.getStatusBadge(t.task)}})]},proxy:!0},{key:"actions",fn:function(){return[e("NcActionButton",{attrs:{icon:"icon-history","close-after-click":!0},on:{click:function(e){return t.restartTask(t.task)}}},[t._v("\n\t\t\t"+t._s("duplicated"===t.getStatusBadge(t.task)?t.t("mediadc","Start"):t.t("mediadc","Restart"))+"\n\t\t")]),t._v(" "),e("NcActionButton",{attrs:{icon:"icon-pause","close-after-click":!0},on:{click:function(e){return t.terminateTask(t.task)}}},[t._v("\n\t\t\t"+t._s(t.t("mediadc","Stop"))+"\n\t\t")]),t._v(" "),e("NcActionButton",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:t.t("mediadc","Create copy of the task"),placement:"left"},expression:"{content: t('mediadc', 'Create copy of the task'), placement: 'left'}"}],attrs:{"close-after-click":!0},on:{click:function(e){return t.duplicateTask(t.task)}},scopedSlots:t._u([{key:"icon",fn:function(){return[e("ContentCopy",{attrs:{size:16}})]},proxy:!0}])},[t._v("\n\t\t\t"+t._s(t.t("mediadc","Duplicate"))+"\n\t\t\t")]),t._v(" "),e("NcActionButton",{attrs:{icon:"icon-delete","close-after-click":!0},on:{click:function(e){return t.deleteTask(t.task)}}},[t._v("\n\t\t\t"+t._s(t.t("mediadc","Delete"))+"\n\t\t")])]},proxy:!0}])})}),[],!1,null,"607c7432",null).exports,NcEmptyContent:D(),ClipboardListOutline:M.Z},mixins:[O.Z],data:function(){return{tasksUpdater:null}},computed:Q({},(0,a.Se)(["tasks"])),beforeMount:function(){var t=this;this.tasksUpdater=setInterval((function(){return t.getTasks(!0)}),5e3)},beforeDestroy:function(){clearInterval(this.tasksUpdater)},methods:Q({},(0,a.nv)(["getTasks"]))};var et=i(13491),nt={};nt.styleTagTransform=N(),nt.setAttributes=b(),nt.insert=x().bind(null,"head"),nt.domAPI=k(),nt.insertStyleElement=_();g()(et.Z,nt);et.Z&&et.Z.locals&&et.Z.locals;const it={name:"Collector",components:{TasksNew:S,TasksList:(0,I.Z)(tt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"tasks-list"},[e("h2",[t._v(t._s(t.t("mediadc","Recent Tasks")))]),t._v(" "),t.tasks.length>0?e("div",[e("transition-group",{attrs:{name:"list",tag:"ul"}},t._l(t.tasks,(function(t){return e("TasksListItem",{key:t.id,staticClass:"task-row",attrs:{task:t}})})),1)],1):e("div",{staticClass:"empty-tasks-list"},[e("NcEmptyContent",{staticStyle:{"margin-top":"5vh"},attrs:{title:t.t("mediadc","No tasks yet"),description:t.t("mediadc","Create a new one!")},scopedSlots:t._u([{key:"icon",fn:function(){return[e("ClipboardListOutline")]},proxy:!0}])})],1)])}),[],!1,null,"7f09c3f2",null).exports},props:{rootTitle:{type:String,required:!0},loading:{type:Boolean,required:!0}},data:function(){return{updating:!1}},beforeMount:function(){var t=this;this.$store.dispatch("getTasks",!0).then((function(){t.$store.dispatch("getSettings").then((function(){t.$emit("update:loading",!1)}))}))}};var st=i(39201),at={};at.styleTagTransform=N(),at.setAttributes=b(),at.insert=x().bind(null,"head"),at.domAPI=k(),at.insertStyleElement=_();g()(st.Z,at);st.Z&&st.Z.locals&&st.Z.locals;const rt=(0,I.Z)(it,(function(){var t=this,e=t._self._c;return t.loading?t._e():e("div",{staticClass:"container"},[e("div",{staticClass:"heading"},[e("h2",[t._v(t._s(t.rootTitle))]),t._v(" "),e("p",[t._v("\n\t\t\t"+t._s(t.t("mediadc","Welcome to Media Duplicate Collector (MediaDC). "))+"\n\t\t\t"+t._s(t.t("mediadc","Here you can manage your duplicate collection tasks and "))+"\n\t\t\t"+t._s(t.t("mediadc","see the history of previous finished tasks."))+"\n\t\t")])]),t._v(" "),e("div",{staticClass:"mediadc-row"},[e("TasksNew"),t._v(" "),e("TasksList")],1)])}),[],!1,null,"9e4bd412",null).exports},99889:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});const i=n(83502).Z},38721:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i});const i=n(89923).Z},4572:(t,e,n)=>{"use strict";n.d(e,{s:()=>i,x:()=>s});var i=function(){var t=this,e=t._self._c;return e("span",t._b({staticClass:"material-design-icon content-copy-icon",attrs:{"aria-hidden":!t.title,"aria-label":t.title,role:"img"},on:{click:function(e){return t.$emit("click",e)}}},"span",t.$attrs,!1),[e("svg",{staticClass:"material-design-icon__svg",attrs:{fill:t.fillColor,width:t.size,height:t.size,viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"}},[t.title?e("title",[t._v(t._s(t.title))]):t._e()])])])},s=[]},31829:(t,e,n)=>{"use strict";n.d(e,{s:()=>i,x:()=>s});var i=function(){var t=this,e=t._self._c;return e("span",t._b({staticClass:"material-design-icon plus-thick-icon",attrs:{"aria-hidden":!t.title,"aria-label":t.title,role:"img"},on:{click:function(e){return t.$emit("click",e)}}},"span",t.$attrs,!1),[e("svg",{staticClass:"material-design-icon__svg",attrs:{fill:t.fillColor,width:t.size,height:t.size,viewBox:"0 0 24 24"}},[e("path",{attrs:{d:"M20 14H14V20H10V14H4V10H10V4H14V10H20V14Z"}},[t.title?e("title",[t._v(t._s(t.title))]):t._e()])])])},s=[]}}]);
//# sourceMappingURL=mediadc-src_views_Collector_vue.js.map?v=7fa77f0b67b2d3e01541